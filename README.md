# Google Apps Script Web Authenticator

这是一个基于 Google Apps Script (GAS) 实现的轻量级 Web 版 Google Authenticator (TOTP 生成器)。

它允许你在任何支持浏览器的设备上，通过一个私有的 Web 界面录入 2FA 密钥，并查看实时生成的 6 位验证码。

## ⚠️ 安全警告

> **请务必阅读：**
> 1.  **风险提示**：本项目将你的 2FA 密钥（Secrets）存储在 Google Apps Script 的 `PropertiesService` 中。虽然这属于你的私有存储空间，但如果你的 Google 账号被入侵，攻击者将同时获得你的邮件访问权和 2FA 验证码。
> 2.  **使用建议**：**请勿**将此工具用于高价值账号（如银行、主邮箱、支付账户等）。建议仅用于测试、学习或非核心服务的两步验证。
> 3.  **访问权限**：部署时请务必将访问权限设置为 **"仅限我自己 (Only myself)"**。

## ✨ 功能特性

* **无需服务器**：完全运行在 Google 云端脚本上，免费且免维护。
* **数据持久化**：账号和密钥存储在 Google 用户属性中，不会随页面刷新丢失。
* **实时刷新**：内置 30 秒倒计时进度条，自动从后端获取最新验证码。
* **简洁界面**：响应式设计，支持手机和桌面端访问。

## 🚀 部署指南

### 第一步：创建项目
1. 访问 [script.google.com](https://script.google.com)。
2. 点击左上角的 **“新项目 (New Project)”**。
3. 将项目重命名为 `My Web Authenticator`。

### 第二步：配置后端代码
1. 在编辑器左侧，点击 `Code.gs`。
2. 删除原有内容，粘贴本项目Code.gs文件里的代码

### 第三步：编写前端界面 (Index.html)
点击左侧的文件列表旁边的 “+” 号，选择 “HTML”，命名为 Index。粘贴本项目Index.html里代码

### 第四步：测试与部署

1. **部署项目**：
    * 点击编辑器右上角的 **“部署 (Deploy)”** -> **“新建部署 (New deployment)”**。(如果有修改则在"Manage deployments"里Edit原版本并选择第一行Version时间为"New Version"以保持发布url不变)
    * 点击左上角的齿轮图标 ⚙️ -> 选择 **“Web 应用 (Web app)”**。
2. **配置选项**：
    * **执行身份 (Execute as)**：选择 **“我 (Me)”**。
    * **谁可以访问 (Who has access)**：**强烈建议**选择 **“仅限我自己 (Only myself)”** (出于安全考虑，防止他人访问你的验证码)。
3. **完成发布**：
    * 点击 **“部署”** 按钮。
    * 复制生成的 **“Web App URL”**。
    * 在浏览器中打开该链接即可开始使用。

#### 🔑 如何获取密钥 (Secret Key)?
当你在第三方网站（如 Google, Github, Facebook）开启两步验证 (2FA) 时：
1.  通常网页会显示一个二维码供 App 扫描。
2.  寻找二维码旁边的 **“无法扫描？”**、**“手动输入”** 或 **“显示密钥 (Show Secret Key)”** 链接。
3.  点击后会显示一串字母和数字（例如 `JBSWY3DPEHPK3PXP`）。
4.  将这串字符复制并粘贴到本工具的 **“密钥”** 输入栏中即可。

---

## 📦 功能说明

* **录入账号**：
    * 在界面下方输入“账号名称”和“密钥”。
    * 数据存储在 Google 账号的 `UserProperties` 中。这是 Google 提供的私有存储空间，**只有该脚本和你本人的 Google 账号**有权限访问，脚本的其他协作者（如果有）无法直接查看该数据。
* **查看验证码**：
    * 界面会自动计算并显示所有已保存账号的当前 6 位验证码。
* **自动刷新**：
    * 顶部设有倒计时进度条。
    * 每当 30 秒周期结束验证码失效时，前端页面会自动请求后端，获取并更新最新的验证码。

## 💡 进阶优化建议

如果你需要更高的安全性或便携性，可以考虑以下改进方向：

* **本地计算 (Client-side Calculation)**：
    * **现状**：目前的逻辑是后端计算 TOTP，前端只负责显示。
    * **改进**：可以修改代码，仅从后端获取加密后的密钥，然后在前端浏览器使用 JavaScript（例如引入 `jsSHA` 库）在本地计算 TOTP。
    * **优势**：密钥只需在加载时传输一次，后续的时间计算完全在本地浏览器完成，减少了网络请求，理论上更安全且响应更快。
